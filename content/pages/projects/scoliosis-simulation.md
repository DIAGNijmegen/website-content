title: Scoliosis simulation for improving a segmentation and labelling algorithm
groups: ai-for-health, diag
finished: false
type: student
picture: projects/scoliosis_modeling.jpg
template: project-single
people: Lars Leijten, Nikolas Lessmann, Dennis Janssen, Max Bakker, Sebastiaan van de Groes
description: Automatic quantification of muscle and fat tissue in 3D CT and MR images

## Clinical problem
Artificial intelligence in medical imaging, is a rapidly innovating field which promises the opportunity of fast and objective analysis of medical images. Automatic processing and analysis of these scans could greatly reduce the costs and required man power in the field of Radiology. In orthopedic surgery, CT scans are often used in surgical planning and navigation, where its use results in increases surgical accuracy and reproducibility. Computerized analysis of these scans could increase the options within and the extent to which imaging is applied in orthopedic surgery of the spine. Automatic segmentation and anatomic labeling of the vertebrae is an important aspect of this analysis and it can help in the detection of osteoporosis, compression fractures, scoliosis or spinal abnormalities related to chronic back pain. Additionally, segmented spinal images can be used in planning and virtual practicing of the surgery, creating 3D-printed drilling guides that exactly fit the spine of the patient and aid the surgeon in accurate screw placement. 

Automatic segmentation and labeling can be performed using convolutional neural networks. These offer the ability to sequentially segment and label vertebrae in different images. These convolutional neural networks are trained in an iterative process where the algorithm is corrected based one a pre-labeled database. To increase the accuracy of the network while avoiding overfitting, a large training set is needed. Existing training data mostly exists of relatively normal spine curvatures, limiting the accuracy of the image analysis algorithm. To increase the robustness of the network, the training data should be extended with a large number of images from deformed spines. A suitable database of labeled and segmented deformed spines is not available and manual labeling and segmentation is enormously time consuming. A possible solution is to generate this data by adapting images of regular spines. 

## Aim of the project
This project aims to generate deformed spinal images from images of regular spines. Normal spine shapes are used to develop a parametric graph model of the spine. These can then be deformed based on values from the literature into e.g. realistic scoliotic curvatures. 

The first step in this project would be to identify realistic curvatures from deformed spines and describe them in functions. With these functions, we can model synthetic spinal shapes and deform pre-segmented and pre-labeled CT and MR images to generate training data in MATLAB. 400 CT scans and 100 MR scans are available for adaptation. This additional training is then added to the overall dataset to train the segmentation and labeling algorithm. Finally, testing of the adapted algorithm will prove if the additional training data increased the robustness of the model and improved segmentation and labeling in a test dataset of at least 20 real scoliotic spines. 

The segmentation accuracy will be evaluated with the most commonly used metrics of the available dataset: The Dice coefficient to measure the volume overlap and the average Absolute Symmetric Surface Distance (ASSD) to measure the accuracy of the segmentation of the surface of the vertebrae. These metrics will be calculated for each vertebrae and will be averaged across all scans.  The identification accuracy will be evaluated by the percentage of vertebrae that were assigned correct anatomical label. The magnitude of the mistakes is measured using the kappa coefficient, which attributes a larger error to larger labeling mistakes (distant different vertebrae). The complete accuracy will be measured with the classification accuracy and the average number of false positives and false negatives per scan. A false positive is characterized as a vertebra which was classified as completely visible by the algorithm, which was not completely visible in the scan. A false negative is a completely visible vertebra on the scan which was classified as not completely visible. 
